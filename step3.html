<h1>Step 3: Updating and Deleting data</h1>

<p>Right now in the comments app, a user can't delete their post if they decide they'd rather not have commented, or edit it if they made a typo. First, you need something for the user to click, so add that to the <code>addComment()</code> function: </p>

<pre><code>function addComment(comment) {
  var editLink = $('&lt;a href="#"&gt;Edit&lt;/a&gt;');
  var deleteLink = $('&lt;a href="#"&gt;Delete&lt;/a&gt;');

  var div = $('&lt;div class="comment"&gt;')
    .append($('&lt;div class="links"&gt;').append(editLink).append(deleteLink))
    .append('&lt;div class="author"&gt;Posted by: ' + comment.name + '&lt;/div&gt;')
    .append('&lt;p&gt;' + comment.comment + '&lt;/p&gt;')
    .appendTo('#comments')
  ;
}
</code></pre>

<p>Let's start with the delete link.  Add this to the bottom of your <code>addComment()</code> function:</p>

<pre><code>deleteLink.click(function() {
  $.ajax(url('/comments/' + comment._id), {
    type: "DELETE",
    success: function() {
      div.remove();
    },
    error: showError
  });     

  return false;
});
</code></pre>

<p>Notice this is almost exactly the same as creating a comment, only with a <code>DELETE</code> method and no data. However, the URL has <code>comment._id</code> appended. In order to delete something, you need to specify what you want to delete. Every Deployd object has an automatically generated <code>_id</code> property for exactly this purpose. This REST request looks something like this:</p>

<pre><code>URL: http://[MYAPP].deploydapp.com/comments/4f7dd6ea7696253010000077
Method: DELETE

204 No Content
</code></pre>

<p>Now for editing. Add this to the <code>addComment()</code> function: </p>

<pre><code>editLink.click(function() {
  var newComment = prompt("Enter the new comment text:", comment.comment);
  $.ajax(url('/comments/' + comment._id), {
    type: "PUT",
    contentType: "application/json",
    data: JSON.stringify({
      name: comment.name,
      comment: newComment
    }),
    success: function(result) {
      div.find('p').text(result.comment);
    },
    error: showError
  });

  return false;
});
</code></pre>

<p>This has the same URL as the <code>DELETE</code> request, but uses a <code>PUT</code> method. </p>

<p>If you run the app now, you should be able to edit and delete comments. This would also be a good time to upload your JavaScript to Deployd.</p>
